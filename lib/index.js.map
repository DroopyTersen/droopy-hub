{"version":3,"sources":["../src/index.js"],"names":["Freezer","require","objectAssign","defaultOptions","cacheKey","cacheEnabled","createHub","defaultState","opts","Object","assign","cache","setupCache","initialState","get","state","hub","getEventHub","defineProperty","cacheState","set","toJS","trigger","key","args","emit","KEY","cachedVal","localStorage","getItem","JSON","parse","ex","val","setItem","stringify","clear","removeItem","module","exports"],"mappings":";;AAAA,IAAIA,UAAUC,QAAQ,YAAR,CAAd;AACA,IAAIC,eAAeD,QAAQ,eAAR,CAAnB;;AAEA,IAAME,iBAAiB;AACnBC,cAAU,kBADS;AAEnBC,kBAAc;AAFK,CAAvB;;AAKA,IAAIC,YAAY,SAAZA,SAAY,CAASC,YAAT,EAAuBC,IAAvB,EAA6B;AACzCA,WAAOC,OAAOC,MAAP,CAAc,EAAd,EAAkBP,cAAlB,EAAkCK,IAAlC,CAAP;AACA,QAAIG,QAAQC,WAAWJ,KAAKJ,QAAhB,CAAZ;AACA,QAAIS,eAAeX,aAAa,EAAb,EAAiBK,YAAjB,EAAgCC,KAAKH,YAAL,GAAoBM,MAAMG,GAAN,EAApB,GAAkC,EAAlE,CAAnB;AACA,QAAIC,QAAQ,IAAIf,OAAJ,CAAYa,YAAZ,CAAZ;;AAEA,QAAIG,MAAMD,MAAME,WAAN,EAAV;AACAR,WAAOS,cAAP,CAAsBF,GAAtB,EAA2B,OAA3B,EAAoC;AAChCF,aAAK;AAAA,mBAAMC,MAAMD,GAAN,EAAN;AAAA;AAD2B,KAApC;AAGAE,QAAIL,KAAJ,GAAYA,KAAZ;AACAK,QAAIG,UAAJ,GAAiB;AAAA,eAAMR,MAAMS,GAAN,CAAUL,MAAMD,GAAN,GAAYO,IAAZ,EAAV,CAAN;AAAA,KAAjB;AACAL,QAAIM,OAAJ,GAAc,UAACC,GAAD;AAAA,0CAASC,IAAT;AAASA,gBAAT;AAAA;;AAAA,eAAkBR,IAAIS,IAAJ,aAASF,GAAT,SAAiBC,IAAjB,EAAlB;AAAA,KAAd;;AAGA,WAAOR,GAAP;AACH,CAhBD;;AAkBA,IAAIJ,aAAa,SAAbA,UAAa,GAAmC;AAAA,QAA1BW,GAA0B,uEAApB,kBAAoB;;AAChD,WAAO;AACHG,aAAKH,GADF;AAEHT,WAFG,iBAEG;AACF,gBAAI;AACA,oBAAIa,YAAYC,aAAaC,OAAb,CAAqBN,GAArB,CAAhB;AACA,uBAAOI,YAAYG,KAAKC,KAAL,CAAWJ,SAAX,CAAZ,GAAoC,IAA3C;AAEH,aAJD,CAIE,OAAOK,EAAP,EAAW;AACT,uBAAO,IAAP;AACH;AACJ,SAVE;AAWHZ,WAXG,eAWCa,GAXD,EAWM;AACL,mBAAOL,aAAaM,OAAb,CAAqBX,GAArB,EAA0BO,KAAKK,SAAL,CAAeF,GAAf,CAA1B,CAAP;AACH,SAbE;AAcHG,aAdG,mBAcK;AACJR,yBAAaS,UAAb,CAAwBd,GAAxB;AACH;AAhBE,KAAP;AAkBH,CAnBD;;AAqBAe,OAAOC,OAAP,GAAiB,EAAEjC,oBAAF,EAAjB","file":"index.js","sourcesContent":["var Freezer = require(\"freezer-js\");\r\nvar objectAssign = require('object-assign');\r\n\r\nconst defaultOptions = {\r\n    cacheKey: \"droopy-hub-cache\",\r\n    cacheEnabled: true\r\n}\r\n\r\nvar createHub = function(defaultState, opts) {\r\n    opts = Object.assign({}, defaultOptions, opts);\r\n    var cache = setupCache(opts.cacheKey);\r\n    var initialState = objectAssign({}, defaultState, (opts.cacheEnabled ? cache.get() : {}));\r\n    var state = new Freezer(initialState);\r\n\r\n    var hub = state.getEventHub();\r\n    Object.defineProperty(hub, \"state\", {\r\n        get: () => state.get()\r\n    })\r\n    hub.cache = cache;\r\n    hub.cacheState = () => cache.set(state.get().toJS());\r\n    hub.trigger = (key, ...args) => hub.emit(key, ...args);\r\n\r\n    \r\n    return hub;\r\n}\r\n\r\nvar setupCache = function(key = \"droopy-hub-cache\") {\r\n    return {\r\n        KEY: key,\r\n        get() {\r\n            try {\r\n                var cachedVal = localStorage.getItem(key);\r\n                return cachedVal ? JSON.parse(cachedVal) : null;\r\n    \r\n            } catch (ex) {\r\n                return null;\r\n            }\r\n        },\r\n        set(val) {\r\n            return localStorage.setItem(key, JSON.stringify(val))\r\n        },\r\n        clear() {\r\n            localStorage.removeItem(key);\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = { createHub };"]}